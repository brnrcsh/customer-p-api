<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:salesforce-system-api="http://www.mulesoft.org/schema/mule/salesforce-system-api" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/salesforce-system-api http://www.mulesoft.org/schema/mule/salesforce-system-api/current/mule-salesforce-system-api.xsd">
	<sub-flow name="customer-event-process_Sub-Flow" doc:id="8affcb43-c208-4799-a07e-f42262b7bd51" >
		<choice doc:name="Choice" doc:id="264185c8-b71a-4c1d-a302-2b64466f7898">
			<when expression='#[upper(vars.kafkaHeaders.method) == "POST"]'>
				<flow-ref doc:name="POST" doc:id="dfd88a46-27d4-461c-85b4-a5c742ccb051" name="customer-event-process-post_Sub-Flow"/>
			</when>
			<when expression='#[upper(vars.kafkaHeaders.method) == "DELETE"]'>
				<flow-ref doc:name="DELETE" doc:id="dc7caf56-d4e5-4cd6-be30-6c751b7a31dd" name="customer-event-process-delete_Sub-Flow" />
			</when>
			<when expression='#[upper(vars.kafkaHeaders.method) == "GET"]'>
				<flow-ref doc:name="PUT" doc:id="ccec4c42-251a-45e7-a7fe-66c2547d8797" name="customer-event-process-put_Sub-Flow" />
			</when>
			<otherwise>
				<raise-error doc:name="RULE:METHOD_INVALID" doc:id="1d3650e0-72d7-47f8-89ce-b990ca6062a0" type="RULE:METHOD_INVALID" description="O metodo informado na mensagem Ã© invalido" />
			</otherwise>
		</choice>
	</sub-flow>
	<sub-flow name="customer-event-process-post_Sub-Flow" doc:id="56540453-b216-463a-a809-36aa7f3e4864" >
		<logger level="INFO" doc:name="Logger" doc:id="89e7bde4-68fd-47db-8482-c534426650a0" />
		<salesforce-system-api:create-customer doc:name="Create customer" doc:id="2a77caa8-9cc1-459e-a6e9-93f3f23688ca" x-correlation-id="#[vars.correlationId]" config-ref="Salesforce___System___API_Config">
			<salesforce-system-api:create-customer-request-data ><![CDATA[#[vars.kafkaBody]]]></salesforce-system-api:create-customer-request-data>
		</salesforce-system-api:create-customer>
	</sub-flow>
	<sub-flow name="customer-event-process-delete_Sub-Flow" doc:id="58911bc9-1d86-4b81-b90e-51bc40378607" >
		<logger level="INFO" doc:name="Logger" doc:id="5451febc-5961-48ad-b9e8-908653953c23" />
		<salesforce-system-api:delete-customer-by-id doc:name="Delete customer by id" doc:id="030512cc-e2d3-4365-a29b-c5be56379f9b" config-ref="Salesforce___System___API_Config" id="#[vars.kafkaHeaders.id]" x-correlation-id="#[vars.correlationId]"/>
	</sub-flow>
	<sub-flow name="customer-event-process-put_Sub-Flow" doc:id="e0f0492f-962a-4485-ba28-0e7721f4cb39" >
		<logger level="INFO" doc:name="Logger" doc:id="79c52330-de4a-4235-92b3-134cfd5e4dcf" />
		<salesforce-system-api:update-customer-by-id doc:name="Update customer by id" doc:id="6721ab82-2ec1-46c1-87e6-1e66dcd39987" config-ref="Salesforce___System___API_Config" id="#[vars.kafkaHeaders.id]" x-correlation-id="#[vars.correlationId]">
			<salesforce-system-api:update-customer-by-id-request-data ><![CDATA[#[vars.kafkaBody]]]></salesforce-system-api:update-customer-by-id-request-data>
		</salesforce-system-api:update-customer-by-id>
	</sub-flow>
</mule>
