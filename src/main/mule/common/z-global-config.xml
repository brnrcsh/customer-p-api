<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:salesforce-system-api="http://www.mulesoft.org/schema/mule/salesforce-system-api"
	xmlns:kafka="http://www.mulesoft.org/schema/mule/kafka"
	xmlns:opentelemetry="http://www.mulesoft.org/schema/mule/opentelemetry" xmlns:apikit="http://www.mulesoft.org/schema/mule/mule-apikit"
	xmlns:http="http://www.mulesoft.org/schema/mule/http"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="
http://www.mulesoft.org/schema/mule/mule-apikit http://www.mulesoft.org/schema/mule/mule-apikit/current/mule-apikit.xsd 
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/opentelemetry http://www.mulesoft.org/schema/mule/opentelemetry/current/mule-opentelemetry.xsd
http://www.mulesoft.org/schema/mule/kafka http://www.mulesoft.org/schema/mule/kafka/current/mule-kafka.xsd
http://www.mulesoft.org/schema/mule/salesforce-system-api http://www.mulesoft.org/schema/mule/salesforce-system-api/current/mule-salesforce-system-api.xsd">
	
	<http:listener-config name="customer-p-api-httpListenerConfig">
		<http:listener-connection
			host="${http.host}"
			port="${http.port}" readTimeout="${http.timeout.read}" connectionIdleTimeout="${http.timeout.connection}"/>
	</http:listener-config>
	
	<apikit:config
		name="customer-p-api-config"
		api="resource::fd910f05-df24-42bd-b701-691e4d055415:customer-p-api:1.0.2:raml:zip:customer-p-api.raml"
		outboundHeadersMapName="outboundHeaders"
		httpStatusVarName="httpStatus" />
	<configuration-properties doc:name="Configuration properties" doc:id="026b4483-2e8d-4ea0-969e-c17b8e1bf08b" file="properties/properties.yaml" />
	<configuration-properties doc:name="Configuration properties" doc:id="cc68740a-232c-4e8c-9262-b24a44751ce7" file="properties/properties-${mule.env}.yaml" />
	<global-property doc:name="Global Property" doc:id="29001f55-44ea-4d79-8a08-75940d68828f" name="mule.env" value="dev" />
	
	<http:request-config name="ElasticSearch_HTTP-Req-conf" doc:name="HTTP Request configuration" doc:id="24276fa7-f95e-4fad-b666-75d886bc9e6d" basePath="/${elasticsearch.index}">
		<http:request-connection host="${elasticsearch.host}" port="${elasticsearch.port}" >
			<reconnection >
				<reconnect frequency="3000" count="5" />
			</reconnection>
		</http:request-connection>
		<http:default-headers >
			<http:default-header key="Authorization" value="${elasticsearch.apiKey}" />
		</http:default-headers>
	</http:request-config>
	
	<opentelemetry:config name="default_OpenTelemetry-Config" doc:name="OpenTelemetry Config" doc:id="53894f66-e8ec-4e6a-a25e-3a3b637279cc" serviceName="bruno-customer-p-api" spanAllProcessors="true" >
		<opentelemetry:resource-attributes >
			<opentelemetry:attribute key="deployment.environment" value="dev" />
		</opentelemetry:resource-attributes>
		<opentelemetry:exporter >
			<opentelemetry:otlp-exporter collectorEndpoint="http://20.84.120.171:5602" requestCompression="GZIP"/>
		</opentelemetry:exporter>
	</opentelemetry:config>
	<kafka:consumer-config name="Apache_Kafka_Consumer_configuration" doc:name="Apache Kafka Consumer configuration" doc:id="4b3ffa40-00e8-4df5-b5fb-1890bc62929a" >
		<kafka:consumer-plaintext-connection groupId="${kafka.groupId}" autoOffsetReset="EARLIEST">
			<kafka:bootstrap-servers >
				<kafka:bootstrap-server value="${kafka.bootstrap.server}" />
			</kafka:bootstrap-servers>
			<kafka:topic-patterns >
				<kafka:topic-pattern value="${kafka.topics.customer}" />
			</kafka:topic-patterns>
		</kafka:consumer-plaintext-connection>
	</kafka:consumer-config>
	<salesforce-system-api:config name="Salesforce___System___API_Config" doc:name="Salesforce - System - API Config" doc:id="6cfc3a49-41a5-4b14-80bf-be1604d38b69" property_host="${mule-salesforce-s-api.host}" property_port="${mule-salesforce-s-api.port}" property_basePath="${mule-salesforce-s-api.basePath}" property_protocol="${mule-salesforce-s-api.protocol}" property_responseTimeout="${mule-salesforce-s-api.timeout}" property_client-id="${mule-salesforce-s-api.client_id}" property_client-secret="${mule-salesforce-s-api.client_secret}" />
	
</mule>
